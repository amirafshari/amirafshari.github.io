<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://amirafshari.github.io/blog</id>
    <title>Amir Afshari Blog</title>
    <updated>2021-09-02T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://amirafshari.github.io/blog"/>
    <subtitle>Amir Afshari Blog</subtitle>
    <icon>https://amirafshari.github.io/img/favicon.ico</icon>
    <entry>
        <title type="html"><![CDATA[Automatic License Plate Detector]]></title>
        <id>https://amirafshari.github.io/blog/license-plate-detector</id>
        <link href="https://amirafshari.github.io/blog/license-plate-detector"/>
        <updated>2021-09-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[result-9]]></summary>
        <content type="html"><![CDATA[<p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/134549834-da73a045-05c9-4d6c-8772-90c4dca67cf7.jpg" alt="result-9" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="exploratory-data-analysis">Exploratory Data Analysis<a href="#exploratory-data-analysis" class="hash-link" aria-label="Direct link to Exploratory Data Analysis" title="Direct link to Exploratory Data Analysis">​</a></h2><p>How our data looks like?<br>
<!-- -->Annotations format (YOLO Format): <!-- -->[class, x_center, y_center, obj_width, obj_height]<!-- -->  </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="distributions">Distributions<a href="#distributions" class="hash-link" aria-label="Direct link to Distributions" title="Direct link to Distributions">​</a></h3><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/134396237-178893ef-18f1-4df6-b3ea-fe4b235e3a27.png" alt="1" class="img_ev3q"></p><p>They make sense for number plate images  </p><ul><li>x values are well distributed, which means the cameraman did a good job :D</li><li>y values are well distributed as well, but, most of the objects are on top of our images.</li><li>both height and width make sense, because our object is licence plate and they all have almost similiar sizes.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="x-vs-y--height-vs-width">X vs Y &amp; Height vs Width<a href="#x-vs-y--height-vs-width" class="hash-link" aria-label="Direct link to X vs Y &amp; Height vs Width" title="Direct link to X vs Y &amp; Height vs Width">​</a></h3><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/134396293-df5113b7-9237-4dfc-81ac-1a2bf6187826.png" alt="2" class="img_ev3q"></p><ul><li>As mentioned above, there is a lack in our dataset in buttom-half part of xy plane.</li><li>As we can see, the center of our x axis is dense, it's beacuse humans put the object in the center of the camera.</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="tensorflow-implementation-for-yolov4">Tensorflow Implementation for YOLOv4<a href="#tensorflow-implementation-for-yolov4" class="hash-link" aria-label="Direct link to Tensorflow Implementation for YOLOv4" title="Direct link to Tensorflow Implementation for YOLOv4">​</a></h2><p><strong>It's <a href="https://github.com/hunglc007/tensorflow-yolov4-tflite#traning-your-own-model" target="_blank" rel="noopener noreferrer">recommended</a> to train your custom detector on <a href="https://amirafshari.com/blog/train-custom-object-detector" target="_blank" rel="noopener noreferrer">darknet</a>, rather than this implemntation, and then convert your weights and use this implemntation.</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!git clone https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">hunglc007</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">tensorflow</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">tflite</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="environment-setup">Environment Setup<a href="#environment-setup" class="hash-link" aria-label="Direct link to Environment Setup" title="Direct link to Environment Setup">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="conda-environment">Conda Environment<a href="#conda-environment" class="hash-link" aria-label="Direct link to Conda Environment" title="Direct link to Conda Environment">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Create</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># tf &lt; 2.5 | python = 3.7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># tf &gt; 2.5 | python &gt; 3.9</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!conda create </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">name envname python</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3.7</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Activate</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!activate envname</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="requirements">Requirements<a href="#requirements" class="hash-link" aria-label="Direct link to Requirements" title="Direct link to Requirements">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># in tf &gt; 2.5 both cpu and gpu use the same package</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># GPU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">r requirements</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gpu</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># CPU</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!pip install </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">r requirements</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="check">Check<a href="#check" class="hash-link" aria-label="Direct link to Check" title="Direct link to Check">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!conda </span><span class="token builtin">list</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># installed packages in current env</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!python </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="set-the-environment-as-jupyter-kernel">Set the environment as jupyter kernel<a href="#set-the-environment-as-jupyter-kernel" class="hash-link" aria-label="Direct link to Set the environment as jupyter kernel" title="Direct link to Set the environment as jupyter kernel">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!pip install ipykernel</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!python </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">m ipykernel install </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">user </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">envname</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then choose yolov4tf from kernels in your notebook</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tensorflow">Tensorflow<a href="#tensorflow" class="hash-link" aria-label="Direct link to Tensorflow" title="Direct link to Tensorflow">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="convert-weights">Convert weights<a href="#convert-weights" class="hash-link" aria-label="Direct link to Convert weights" title="Direct link to Convert weights">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!python save_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">weights </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">weights </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">output </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkpoints</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">input_size </span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">model yolov4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="coco-dataset">COCO Dataset<a href="#coco-dataset" class="hash-link" aria-label="Direct link to COCO Dataset" title="Direct link to COCO Dataset">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!python detect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">weights </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkpoints</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size </span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">model yolov4 </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">image </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kite</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jpg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-dataset">Custom Dataset<a href="#custom-dataset" class="hash-link" aria-label="Direct link to Custom Dataset" title="Direct link to Custom Dataset">​</a></h4><ul><li>Create a custom.names file in data/classes and type your class (based on your weights and training)</li><li>Call the custom.names in config.py (change coco.names to custom.names)</li><li>Change the paths in detect.py</li></ul><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!python detect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">weights </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkpoints</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">custom </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size </span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">model yolov4 </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">image </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">custom</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jpg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/134549864-703159d9-a8f2-41d0-b4ef-48e52bf770b9.jpg" alt="result" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-tflite">3. Tflite<a href="#3-tflite" class="hash-link" aria-label="Direct link to 3. Tflite" title="Direct link to 3. Tflite">​</a></h3><p>Recommended for mobile and edge devices.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="convert">Convert<a href="#convert" class="hash-link" aria-label="Direct link to Convert" title="Direct link to Convert">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Save tf model for tflite converting</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!python save_model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">weights </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">weights </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">output </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkpoints</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">input_size </span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">model yolov4 </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">framework tflite</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># YOLOv4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!python convert_tflite</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">weights </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkpoints</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">output </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkpoints</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">416</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tflite</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="demo">Demo<a href="#demo" class="hash-link" aria-label="Direct link to Demo" title="Direct link to Demo">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!python detect</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">weights </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkpoints</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">416</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">tflite </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size </span><span class="token number" style="color:#36acaa">416</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">model yolov4 </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">image </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">kite</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jpg </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">framework tflite</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/134549834-da73a045-05c9-4d6c-8772-90c4dca67cf7.jpg" alt="result-9" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="metrics">Metrics<a href="#metrics" class="hash-link" aria-label="Direct link to Metrics" title="Direct link to Metrics">​</a></h2><ul><li>Precision: 91 %</li><li>Average Precision: 89.80 %</li><li>Recall: 86 %</li><li>F1-score: 88 %</li><li>Average IoU: 74.06 %</li><li><a href="mailto:mAP@0.5" target="_blank" rel="noopener noreferrer">mAP@0.5</a>: 89.80 %</li><li>Confusion Matrix:<ul><li>TP = 439</li><li>FP = 45</li><li>FN = 73</li><li>unique_truth_count (TP+FN) = 512</li><li>detections_count = 805</li></ul></li></ul>]]></content>
        <author>
            <name>Amir Afshari</name>
            <uri>https://github.com/amirafshari</uri>
        </author>
        <category label="Object Detection" term="Object Detection"/>
        <category label="Computer Vision" term="Computer Vision"/>
        <category label="Deep Learning" term="Deep Learning"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Train a Custom Object Detector]]></title>
        <id>https://amirafshari.github.io/blog/train-custom-object-detector</id>
        <link href="https://amirafshari.github.io/blog/train-custom-object-detector"/>
        <updated>2021-08-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[download]]></summary>
        <content type="html"><![CDATA[<p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138662797-827178bd-ce03-4896-b093-1705c3ac6d4f.png" alt="download" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="darknet-configurations">Darknet Configurations<a href="#darknet-configurations" class="hash-link" aria-label="Direct link to Darknet Configurations" title="Direct link to Darknet Configurations">​</a></h2><p><strong>This documentation is for Google Colab. If you want to know how to compile darknet on your linux local machine (Ubuntu 20.04), please read <a href="https://github.com/amirafshari/LPD-YOLOv4/blob/master/darknet-linux.md" target="_blank" rel="noopener noreferrer">this documentation</a>.</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># clone repo</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#!git clone https://github.com/AlexeyAB/darknet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!git clone https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">amirafshari</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">LPD</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">YOLOv4</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gpu">GPU<a href="#gpu" class="hash-link" aria-label="Direct link to GPU" title="Direct link to GPU">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># change makefile to have GPU and OPENCV enabled</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">cd darknet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!sed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i </span><span class="token string" style="color:#e3116c">'s/OPENCV=0/OPENCV=1/'</span><span class="token plain"> Makefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!sed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i </span><span class="token string" style="color:#e3116c">'s/GPU=0/GPU=1/'</span><span class="token plain"> Makefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!sed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i </span><span class="token string" style="color:#e3116c">'s/CUDNN=0/CUDNN=1/'</span><span class="token plain"> Makefile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!sed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i </span><span class="token string" style="color:#e3116c">'s/CUDNN_HALF=0/CUDNN_HALF=1/'</span><span class="token plain"> Makefile</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># verify CUDA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">usr</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">local</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cuda</span><span class="token operator" style="color:#393A34">/</span><span class="token builtin">bin</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">nvcc </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">version</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># make darknet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!make</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="weights">Weights<a href="#weights" class="hash-link" aria-label="Direct link to Weights" title="Direct link to Weights">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># pre-trained weights on MS COCO dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!wget https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">AlexeyAB</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">releases</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">download</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet_yolo_v3_optimal</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">weights</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># pre-trained weights for the convolutional layers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!wget https</span><span class="token punctuation" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">//</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">AlexeyAB</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">releases</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">download</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet_yolo_v3_optimal</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">137</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="generate-traintxt-and-testtxt">Generate train.txt and test.txt<a href="#generate-traintxt-and-testtxt" class="hash-link" aria-label="Direct link to Generate train.txt and test.txt" title="Direct link to Generate train.txt and test.txt">​</a></h3><p>These files are not in the official repo, but you can find them in my repository.</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!python generate_train</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!python generate_test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">py</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configurations">Configurations<a href="#configurations" class="hash-link" aria-label="Direct link to Configurations" title="Direct link to Configurations">​</a></h3><p>We need to change/create these files (I configured them for our object (which is license plate), and put them in this repository):</p><ul><li>data/obj.names</li><li>data/obj.data</li><li>cfg/yolov4-custom.cgf</li><li>cfg/yolov4-obj.cfg</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="training">Training<a href="#training" class="hash-link" aria-label="Direct link to Training" title="Direct link to Training">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configurations-1">Configurations<a href="#configurations-1" class="hash-link" aria-label="Direct link to Configurations" title="Direct link to Configurations">​</a></h3><p><a href="https://github.com/AlexeyAB/darknet#how-to-train-to-detect-your-custom-objects" target="_blank" rel="noopener noreferrer">https://github.com/AlexeyAB/darknet#how-to-train-to-detect-your-custom-objects</a>  </p><ul><li>1 Epoch = images_in_train_txt / batch = 2000 / 32 = 62.5</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="train">Train<a href="#train" class="hash-link" aria-label="Direct link to Train" title="Direct link to Train">​</a></h3><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># Access Denied Error</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!chmod </span><span class="token operator" style="color:#393A34">+</span><span class="token plain">x </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># set custom cfg to train mode </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">cd cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!sed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i </span><span class="token string" style="color:#e3116c">'s/batch=1/batch=64/'</span><span class="token plain"> yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!sed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i </span><span class="token string" style="color:#e3116c">'s/subdivisions=1/subdivisions=16/'</span><span class="token plain"> yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">cd </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet detector train </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cfg</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg yolov4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conv</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">137</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dont_show </span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">map</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="restart">Restart<a href="#restart" class="hash-link" aria-label="Direct link to Restart" title="Direct link to Restart">​</a></h3><p>In case of intruption, we can restart training from our last weight.<br>
<!-- -->(every 100 iterations our weights are saved to backup folder in yolov4-obj_last.weights) (~every 30 minutes)<br>
<!-- -->(every 1000 iterations our weight are saved to backup folder in yolo-obj_xxxx.weights)</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet detector train </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cfg</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">backup</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj_last</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">weights </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dont_show </span><span class="token operator" style="color:#393A34">-</span><span class="token builtin">map</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sanity-check">Sanity Check<a href="#sanity-check" class="hash-link" aria-label="Direct link to Sanity Check" title="Direct link to Sanity Check">​</a></h2><h4 class="anchor anchorWithStickyNavbar_LWe7" id="setup">Setup<a href="#setup" class="hash-link" aria-label="Direct link to Setup" title="Direct link to Setup">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># set custom cfg to test mode </span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">cd cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!sed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i </span><span class="token string" style="color:#e3116c">'s/batch=64/batch=1/'</span><span class="token plain"> yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">!sed </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">i </span><span class="token string" style="color:#e3116c">'s/subdivisions=16/subdivisions=1/'</span><span class="token plain"> yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">%</span><span class="token plain">cd </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">imShow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> cv2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">%</span><span class="token plain">matplotlib inline</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">imread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  height</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> width </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> image</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  resized_image </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">resize</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">width</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token operator" style="color:#393A34">*</span><span class="token plain">height</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> interpolation </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">INTER_CUBIC</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fig </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">gcf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fig</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">set_size_inches</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">18</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">axis</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"off"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cvtColor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">resized_image</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cv2</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">COLOR_BGR2RGB</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  plt</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="coco-dataset">COCO Dataset<a href="#coco-dataset" class="hash-link" aria-label="Direct link to COCO Dataset" title="Direct link to COCO Dataset">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet detector test cfg</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">coco</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data cfg</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg yolov4</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">weights data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">person</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">jpg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">imShow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'./predictions.jpg'</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138662797-827178bd-ce03-4896-b093-1705c3ac6d4f.png" alt="download" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="custom-dataset">Custom Dataset<a href="#custom-dataset" class="hash-link" aria-label="Direct link to Custom Dataset" title="Direct link to Custom Dataset">​</a></h4><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet detector test </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">cfg</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">backup</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj_last</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">weights </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">Cars354</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">png </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">thresh </span><span class="token number" style="color:#36acaa">0.3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">imShow</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'./predictions.jpg'</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/134551901-37ff3f6d-37ae-42dc-96c3-8064786355fe.jpg" alt="result-4" class="img_ev3q"></p><p><strong>To process a list of images data/train.txt and save results of detection to result.json file use</strong></p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet detector test data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data cfg</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg backup</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj_last</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">weights </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">ext_output </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dont_show </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">out result</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">json </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">test</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="metrics">Metrics<a href="#metrics" class="hash-link" aria-label="Direct link to Metrics" title="Direct link to Metrics">​</a></h2><p><strong>Use -map flag while training for charts</strong><br>
<!-- -->mAP-chart (red-line) and Loss-chart (blue-line) will be saved in root directory.<br>
<!-- -->mAP will be calculated for each 4 Epochs ~ 240 batches</p><div class="language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">!</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">darknet detector </span><span class="token builtin">map</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">data cfg</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yolov4</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">obj</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cfg backup</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">custom</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">weights</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>Amir Afshari</name>
            <uri>https://github.com/amirafshari</uri>
        </author>
        <category label="Object Detection" term="Object Detection"/>
        <category label="Computer Vision" term="Computer Vision"/>
        <category label="Deep Learning" term="Deep Learning"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Housing Data Analysis]]></title>
        <id>https://amirafshari.github.io/blog/housing-data-analysis</id>
        <link href="https://amirafshari.github.io/blog/housing-data-analysis"/>
        <updated>2020-08-28T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[density2]]></summary>
        <content type="html"><![CDATA[<p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138718424-6f6cd0c6-c5a6-4442-a058-80968fc29035.png" alt="density2" class="img_ev3q"></p><p>This dataset is based on data from the 1990 California census. Our dataset consist of 26k samples with 10 features.</p><p>features = <!-- -->[longitude, latitude, housing_median_age, total_rooms, total_bedrooms, population, households, median_income, median_house_value, ocean_proximity]</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ocean-proximity-count">Ocean Proximity Count<a href="#ocean-proximity-count" class="hash-link" aria-label="Direct link to Ocean Proximity Count" title="Direct link to Ocean Proximity Count">​</a></h2><p>Ocean Proximity is our only categorical data in this dataset.</p><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138718362-f419fed8-b34c-41cb-9cb2-09f3ce13e5e5.png" alt="ocean_proximity" class="img_ev3q">
<img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138718371-c17dede1-247e-4090-b54f-6d650121d9cb.png" alt="ocean_proximity-pie" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="where-are-the-most-populated-areas">Where are the most populated areas?<a href="#where-are-the-most-populated-areas" class="hash-link" aria-label="Direct link to Where are the most populated areas?" title="Direct link to Where are the most populated areas?">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="population-density-recongnition">Population Density Recongnition<a href="#population-density-recongnition" class="hash-link" aria-label="Direct link to Population Density Recongnition" title="Direct link to Population Density Recongnition">​</a></h3><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138718446-ca1aab50-45b3-4094-86ef-bcb9a4fb07fc.png" alt="density" class="img_ev3q">
<img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138718413-3e29fa00-2f4f-4967-a752-39ce56fb455b.png" alt="density1" class="img_ev3q">
<img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138718424-6f6cd0c6-c5a6-4442-a058-80968fc29035.png" alt="density2" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="correlations">Correlations<a href="#correlations" class="hash-link" aria-label="Direct link to Correlations" title="Direct link to Correlations">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="median-income-vs-median-house-value-strongest-correlation">Median Income vs Median House Value (Strongest Correlation)<a href="#median-income-vs-median-house-value-strongest-correlation" class="hash-link" aria-label="Direct link to Median Income vs Median House Value (Strongest Correlation)" title="Direct link to Median Income vs Median House Value (Strongest Correlation)">​</a></h3><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138719144-34f2ed03-e332-4646-811b-3569a8d5f7ae.png" alt="correlations" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="distribution-of-features">Distribution of Features<a href="#distribution-of-features" class="hash-link" aria-label="Direct link to Distribution of Features" title="Direct link to Distribution of Features">​</a></h2><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138719163-09cf03d6-64e9-409e-b647-66529e2abb73.png" alt="feature-distribution" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="outliers">Outliers<a href="#outliers" class="hash-link" aria-label="Direct link to Outliers" title="Direct link to Outliers">​</a></h2><p><img loading="lazy" src="https://user-images.githubusercontent.com/17769927/138719182-5addddd8-398f-4cb5-9bd7-b293820d9ff2.png" alt="outliers" class="img_ev3q"></p>]]></content>
        <author>
            <name>Amir Afshari</name>
            <uri>https://github.com/amirafshari</uri>
        </author>
        <category label="Data Analysis" term="Data Analysis"/>
        <category label="Data Visualization" term="Data Visualization"/>
    </entry>
</feed>